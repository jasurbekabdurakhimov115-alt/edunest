<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDUNEST - IELTS Listening Mock Test</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
        }

        .header {
            background: white;
            border-bottom: 3px solid #dc143c;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            font-size: 28px;
            font-weight: 700;
            color: #dc143c;
            letter-spacing: 1px;
        }

        .candidate-name {
            font-size: 16px;
            color: #333;
            font-weight: 500;
        }

        .header-icons {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
            color: #666;
        }

        .content-header {
            background: #e8e8e8;
            padding: 20px 40px;
            border-bottom: 1px solid #ddd;
        }

        .part-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .part-instructions {
            font-size: 15px;
            color: #666;
        }

        .main-container {
            background: white;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
            min-height: calc(100vh - 200px);
            padding-bottom: 100px;
        }

        .section-divider {
            background: #dc143c;
            color: white;
            padding: 20px 30px;
            margin: 40px -40px 30px -40px;
            font-size: 20px;
            font-weight: 700;
        }

        .section-divider:first-of-type {
            margin-top: 0;
        }

        .question-block {
            margin-bottom: 40px;
        }

        .question-item {
            margin-bottom: 25px;
        }

        .question-text {
            margin-bottom: 12px;
            color: #333;
            line-height: 1.6;
            font-size: 15px;
        }

        .question-number {
            font-weight: 600;
            margin-right: 8px;
        }

        input[type="text"] {
            width: 250px;
            padding: 8px 12px;
            border: 2px solid #999;
            border-radius: 4px;
            font-size: 15px;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #333;
        }

        select {
            width: 100%;
            max-width: 300px;
            padding: 10px;
            border: 2px solid #999;
            border-radius: 4px;
            font-size: 15px;
            font-family: 'Inter', sans-serif;
            background: white;
        }

        select:focus {
            outline: none;
            border-color: #333;
        }

        .word-wrapper {
            display: inline;
            cursor: pointer;
            padding: 1px 0;
            transition: background-color 0.2s ease;
        }

        .word-wrapper:hover {
            background-color: rgba(255, 235, 59, 0.3);
        }

        .highlighted-word {
            background-color: #ffeb3b;
            border-radius: 2px;
            padding: 2px 1px;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #ddd;
            padding: 15px 30px;
            display: flex;
            justify-content: center;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.05);
        }

        .submit-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 40px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .submit-btn:hover {
            background: #218838;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            font-size: 24px;
            font-weight: 700;
            color: #dc143c;
            margin-bottom: 20px;
            text-align: center;
        }

        .answer-sheet {
            margin: 20px 0;
        }

        .answer-item {
            padding: 12px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
        }

        .answer-label {
            font-weight: 600;
            color: #333;
        }

        .answer-value {
            color: #dc143c;
            font-weight: 600;
        }

        .copy-btn, .close-btn {
            padding: 10px 24px;
            font-size: 15px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
            border: none;
        }

        .copy-btn {
            background: #28a745;
            color: white;
        }

        .close-btn {
            background: #6c757d;
            color: white;
        }

        .proctoring-warning {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #dc143c;
            color: white;
            padding: 40px;
            border-radius: 8px;
            text-align: center;
            z-index: 3000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .proctoring-warning h2 {
            font-size: 28px;
            margin-bottom: 20px;
        }

        .instructions-page {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 40px 20px;
        }

        .instructions-container {
            background: white;
            max-width: 800px;
            width: 100%;
            border-radius: 12px;
            padding: 50px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .instructions-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .instructions-logo {
            font-size: 42px;
            color: #dc143c;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .instructions-title {
            font-size: 28px;
            color: #1a1a2e;
            margin-top: 20px;
            font-weight: 600;
        }

        .instruction-section {
            margin-bottom: 25px;
        }

        .instruction-section h3 {
            color: #dc143c;
            font-size: 20px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .instruction-section ul {
            list-style: none;
            padding-left: 0;
        }

        .instruction-section ul li {
            padding: 10px 0 10px 30px;
            position: relative;
            line-height: 1.6;
            color: #333;
        }

        .instruction-section ul li:before {
            content: "•";
            color: #dc143c;
            font-size: 24px;
            position: absolute;
            left: 0;
            top: 5px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box strong {
            color: #dc143c;
            font-size: 18px;
        }

        .name-input-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
            border: 2px solid #dc143c;
        }

        .name-input-section label {
            display: block;
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .name-input-section input {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 4px;
        }

        .name-input-section input:focus {
            outline: none;
            border-color: #dc143c;
        }

        .start-test-btn {
            width: 100%;
            background: #dc143c;
            color: white;
            border: none;
            padding: 18px;
            font-size: 20px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
        }

        .start-test-btn:hover:not(:disabled) {
            background: #b71c1c;
        }

        .start-test-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .test-page {
            display: none;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #999;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #666;
        }

        .instructions-text {
            font-style: italic;
            color: #666;
            margin-bottom: 20px;
            font-size: 14px;
            background: #f0f8ff;
            padding: 15px;
            border-radius: 4px;
        }

        .table-style {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .table-style th,
        .table-style td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .table-style th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .option-box {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .option-box p {
            margin: 5px 0;
            font-size: 15px;
        }

        .notes-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 4px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
        }

        .notes-box h4 {
            margin-bottom: 15px;
            color: #000;
            font-size: 16px;
        }

        .notes-box p {
            margin: 10px 0;
            color: #333;
            line-height: 1.6;
        }

        .checkbox-group {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }

        .checkbox-item {
            margin: 10px 0;
        }

        .checkbox-item label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 15px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Instructions Page -->
    <div class="instructions-page" id="instructionsPage">
        <div class="instructions-container">
            <div class="instructions-header">
                <div class="instructions-logo">EDUNEST</div>
                <h1 class="instructions-title">IELTS Listening Mock Test</h1>
                <p style="color: #666; margin-top: 10px;">Complete Listening Test - 4 Parts</p>
                <p style="color: #666; margin-top: 5px;">40 Questions Total</p>
            </div>

            <div class="instructions-content">
                <div class="instruction-section">
                    <h3>Test Instructions</h3>
                    <ul>
                        <li>The test contains 4 sections with 40 questions (Questions 1-40)</li>
                        <li>Answer all questions as you listen to the audio</li>
                        <li>You can review and change your answers at any time</li>
                        <li>Click on any word to highlight it for reference</li>
                        <li>Your answers will be automatically saved as you type</li>
                    </ul>
                </div>

                <div class="instruction-section">
                    <h3>Proctoring Rules</h3>
                    <ul>
                        <li>The test MUST be completed in full-screen mode</li>
                        <li>Do NOT switch tabs or windows during the test</li>
                        <li>Do NOT exit full-screen mode</li>
                        <li>Do NOT minimize the browser</li>
                        <li>Do NOT use any other applications</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <strong>⚠️ WARNING:</strong><br>
                    If you violate any proctoring rule (switch tabs, exit full-screen, or leave the test window), your test will be automatically terminated and all your answers will be deleted. Only ONE violation is allowed.
                </div>

                <div class="name-input-section">
                    <label for="studentName">
                        <span style="color: #dc143c;">*</span> Enter Your Full Name (Required):
                    </label>
                    <input 
                        type="text" 
                        id="studentName" 
                        placeholder="Enter your full name here..."
                        oninput="validateName()"
                    >
                </div>

                <button class="start-test-btn" id="startBtn" onclick="startTest()" disabled>
                    Start Test in Full Screen
                </button>
            </div>
        </div>
    </div>

    <!-- Test Page -->
    <div class="test-page" id="testPage">
        <div class="header">
            <div class="logo-section">
                <div class="logo">EDUNEST</div>
                <div class="candidate-name" id="headerName"></div>
            </div>
            
            <div class="header-icons">
                <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
                </svg>
                
                <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/>
                </svg>
                
                <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                </svg>
            </div>
        </div>

        <div class="content-header">
            <div class="part-title">IELTS Listening Test</div>
            <div class="part-instructions">Complete all 40 questions across 4 sections</div>
        </div>

        <div class="main-container" id="mainContainer">
            
            <!-- SECTION 1 -->
            <div class="section-divider">SECTION 1 - Questions 1-10</div>
            
            <div class="question-block">
                <p class="instructions-text">Complete the table below.<br>
                Write ONE WORD AND/OR A NUMBER for each answer.</p>

                <h4 style="font-weight: 600; margin-bottom: 20px;">Ohope Holiday Park: Accommodation</h4>

                <table class="table-style">
                    <thead>
                        <tr>
                            <th>Type of cabin</th>
                            <th>Location</th>
                            <th>Facilities</th>
                            <th>Cost and charges</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Basic</td>
                            <td>next to the pool</td>
                            <td>kitchen has a fridge and a <span class="question-number">1</span><input type="text" id="q1" placeholder="answer" onchange="saveAnswer(1, this.value)" style="width: 120px;"></td>
                            <td>$35 per night</td>
                        </tr>
                        <tr>
                            <td>Standard</td>
                            <td>close to <span class="question-number">2</span><input type="text" id="q2" placeholder="answer" onchange="saveAnswer(2, this.value)" style="width: 120px;"></td>
                            <td>fully-equipped kitchen and a <span class="question-number">3</span><input type="text" id="q3" placeholder="answer" onchange="saveAnswer(3, this.value)" style="width: 120px;"></td>
                            <td>$55 per night</td>
                        </tr>
                        <tr>
                            <td>Standard Plus</td>
                            <td>facing the <span class="question-number">4</span><input type="text" id="q4" placeholder="answer" onchange="saveAnswer(4, this.value)" style="width: 120px;"></td>
                            <td>comes with own spa</td>
                            <td>discount of <span class="question-number">5</span><input type="text" id="q5" placeholder="answer" onchange="saveAnswer(5, this.value)" style="width: 80px;">% for bookings over ten nights</td>
                        </tr>
                    </tbody>
                </table>

                <h4 style="font-weight: 600; margin: 30px 0 15px 0;">General information about the holiday park and the Ohope area</h4>

                <div class="question-item">
                    <div class="question-text">
                        The children can play <span class="question-number">6</span>
                        <input type="text" id="q6" placeholder="answer" onchange="saveAnswer(6, this.value)" style="width: 150px;"> for free.
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text">
                        It's possible to hire equipment for <span class="question-number">7</span>
                        <input type="text" id="q7" placeholder="answer" onchange="saveAnswer(7, this.value)" style="width: 150px;"> for an afternoon.
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text">
                        The children could visit the local <span class="question-number">8</span>
                        <input type="text" id="q8" placeholder="answer" onchange="saveAnswer(8, this.value)" style="width: 150px;"> on Saturday and Sunday.
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text">
                        There are guided tours of the <span class="question-number">9</span>
                        <input type="text" id="q9" placeholder="answer" onchange="saveAnswer(9, this.value)" style="width: 150px;"> every evening to see the birds.
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text">
                        Contact <span class="question-number">10</span>
                        <input type="text" id="q10" placeholder="answer" onchange="saveAnswer(10, this.value)" style="width: 150px;"> to confirm the booking.
                    </div>
                </div>
            </div>

            <!-- SECTION 2 -->
            <div class="section-divider">SECTION 2 - Questions 11-20</div>

            <!-- Questions 11-12 -->
            <div class="question-block">
                <p class="instructions-text">Choose the correct letter, A, B or C.</p>

                <div class="question-item">
                    <div class="question-text" style="margin-bottom: 15px;">
                        <span class="question-number">11</span>
                        Joan normally gets up at
                    </div>
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 4px;">
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q11" value="A" onchange="saveAnswer(11, 'A')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">A - 5.30 a.m.</span>
                        </label>
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q11" value="B" onchange="saveAnswer(11, 'B')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">B - 6.30 a.m.</span>
                        </label>
                        <label style="display: block; cursor: pointer;">
                            <input type="radio" name="q11" value="C" onchange="saveAnswer(11, 'C')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">C - 7.30 a.m.</span>
                        </label>
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text" style="margin-bottom: 15px;">
                        <span class="question-number">12</span>
                        Joan's first task of the day is to
                    </div>
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 4px;">
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q12" value="A" onchange="saveAnswer(12, 'A')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">A - clean the horses.</span>
                        </label>
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q12" value="B" onchange="saveAnswer(12, 'B')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">B - organise her son.</span>
                        </label>
                        <label style="display: block; cursor: pointer;">
                            <input type="radio" name="q12" value="C" onchange="saveAnswer(12, 'C')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">C - do farm work.</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Questions 13-14 -->
            <div class="question-block">
                <p class="instructions-text">Complete the summary below.<br>
                Write ONE WORD AND/OR A NUMBER for each answer.</p>

                <p style="margin-bottom: 15px; line-height: 1.8;">Joan's official title in Riding for the Disabled (RDA) is chairperson. In her local district there are at present twenty-two riders and <span class="question-number">13</span> <input type="text" id="q13" placeholder="answer" onchange="saveAnswer(13, this.value)" style="width: 100px;"> helpers on the volunteer list, out of whom <span class="question-number">14</span> <input type="text" id="q14" placeholder="answer" onchange="saveAnswer(14, this.value)" style="width: 100px;"> come regularly.</p>
            </div>

            <!-- Questions 15-18 -->
            <div class="question-block">
                <p class="instructions-text">How much does Joan like doing each of the following activities?<br>
                Write the correct letter, A, B or C, next to questions 15-18.</p>

                <div class="option-box">
                    <p><strong>A</strong> She really likes it.</p>
                    <p><strong>B</strong> She doesn't mind it.</p>
                    <p><strong>C</strong> She hates it.</p>
                </div>

                <p style="font-weight: 600; margin: 20px 0 15px 0;">Activities</p>

                <div class="question-item">
                    <div class="question-text">
                        <span class="question-number">15</span> correspondence
                        <select id="q15" onchange="saveAnswer(15, this.value)" style="max-width: 150px;">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                        </select>
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text">
                        <span class="question-number">16</span> fund-raising
                        <select id="q16" onchange="saveAnswer(16, this.value)" style="max-width: 150px;">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                        </select>
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text">
                        <span class="question-number">17</span> calling riders
                        <select id="q17" onchange="saveAnswer(17, this.value)" style="max-width: 150px;">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                        </select>
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text">
                        <span class="question-number">18</span> organising accounts
                        <select id="q18" onchange="saveAnswer(18, this.value)" style="max-width: 150px;">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Questions 19-20 -->
            <div class="question-block">
                <p class="instructions-text">Choose TWO letters, A-E.<br>
                Joan says the TWO ways the RDA needs to improve are by</p>

                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="A" onchange="saveCheckbox(19, 20, 'A', this.checked)">
                            <span>A - giving special training.</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="B" onchange="saveCheckbox(19, 20, 'B', this.checked)">
                            <span>B - making fund-raising more effective.</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="C" onchange="saveCheckbox(19, 20, 'C', this.checked)">
                            <span>C - opening more RDA centres.</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="D" onchange="saveCheckbox(19, 20, 'D', this.checked)">
                            <span>D - providing more helpers.</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="E" onchange="saveCheckbox(19, 20, 'E', this.checked)">
                            <span>E - recognising difficulties of disabled riders.</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- SECTION 3 -->
            <div class="section-divider">SECTION 3 - Questions 21-30</div>

            <!-- Questions 21-22 -->
            <div class="question-block">
                <p class="instructions-text">Choose TWO letters, A-E.<br>
                What do the speakers agree are the TWO reasons why children play outdoors less now than in the past?</p>

                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="A" onchange="saveCheckbox(21, 22, 'A', this.checked)">
                            <span>A - concerns about traffic</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="B" onchange="saveCheckbox(21, 22, 'B', this.checked)">
                            <span>B - limited outdoor play facilities</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="C" onchange="saveCheckbox(21, 22, 'C', this.checked)">
                            <span>C - increased time spent online</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="D" onchange="saveCheckbox(21, 22, 'D', this.checked)">
                            <span>D - preference for indoor play</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="E" onchange="saveCheckbox(21, 22, 'E', this.checked)">
                            <span>E - reduction in free time</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Questions 23-24 -->
            <div class="question-block">
                <p class="instructions-text">Choose TWO letters, A-E.<br>
                In his assignment, which TWO aspects of outdoor play does Ravi want to focus on?</p>

                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="A" onchange="saveCheckbox(23, 24, 'A', this.checked)">
                            <span>A - how it helps children to evaluate risk</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="B" onchange="saveCheckbox(23, 24, 'B', this.checked)">
                            <span>B - how it broadens their horizons</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="C" onchange="saveCheckbox(23, 24, 'C', this.checked)">
                            <span>C - how it aids children's muscular development</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="D" onchange="saveCheckbox(23, 24, 'D', this.checked)">
                            <span>D - how it improves children's digestion</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="E" onchange="saveCheckbox(23, 24, 'E', this.checked)">
                            <span>E - how it teaches children about the environment</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Questions 25-26 -->
            <div class="question-block">
                <p class="instructions-text">Choose TWO letters, A-E.<br>
                According to Ravi, in which TWO ways are children's periods of outdoor play now different from a generation ago?</p>

                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="A" onchange="saveCheckbox(25, 26, 'A', this.checked)">
                            <span>A - They are less dangerous.</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="B" onchange="saveCheckbox(25, 26, 'B', this.checked)">
                            <span>B - They involve fewer children.</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="C" onchange="saveCheckbox(25, 26, 'C', this.checked)">
                            <span>C - They usually last a shorter time.</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="D" onchange="saveCheckbox(25, 26, 'D', this.checked)">
                            <span>D - They include fewer made-up games.</span>
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" value="E" onchange="saveCheckbox(25, 26, 'E', this.checked)">
                            <span>E - They involve fewer chasing games.</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Questions 27-30 -->
            <div class="question-block">
                <p class="instructions-text">Choose the correct letter, A, B or C.</p>

                <div class="question-item">
                    <div class="question-text" style="margin-bottom: 15px;">
                        <span class="question-number">27</span>
                        Ravi thinks parents should be more concerned about the decline of outdoor play because
                    </div>
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 4px;">
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q27" value="A" onchange="saveAnswer(27, 'A')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">A - it affects family relationships.</span>
                        </label>
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q27" value="B" onchange="saveAnswer(27, 'B')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">B - it leads to health problems later in life.</span>
                        </label>
                        <label style="display: block; cursor: pointer;">
                            <input type="radio" name="q27" value="C" onchange="saveAnswer(27, 'C')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">C - it makes childhood less enjoyable.</span>
                        </label>
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text" style="margin-bottom: 15px;">
                        <span class="question-number">28</span>
                        What does Ravi say that schools should do with regard to outdoor play?
                    </div>
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 4px;">
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q28" value="A" onchange="saveAnswer(28, 'A')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">A - revise their aims</span>
                        </label>
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q28" value="B" onchange="saveAnswer(28, 'B')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">B - spend more money on it</span>
                        </label>
                        <label style="display: block; cursor: pointer;">
                            <input type="radio" name="q28" value="C" onchange="saveAnswer(28, 'C')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">C - listen to the views of parents</span>
                        </label>
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text" style="margin-bottom: 15px;">
                        <span class="question-number">29</span>
                        What did Smith and Barker say about children in rural areas?
                    </div>
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 4px;">
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q29" value="A" onchange="saveAnswer(29, 'A')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">A - They tend not to be allowed on farmland.</span>
                        </label>
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q29" value="B" onchange="saveAnswer(29, 'B')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">B - They receive more supervision out of doors.</span>
                        </label>
                        <label style="display: block; cursor: pointer;">
                            <input type="radio" name="q29" value="C" onchange="saveAnswer(29, 'C')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">C - They spend more time outdoors than city children.</span>
                        </label>
                    </div>
                </div>

                <div class="question-item">
                    <div class="question-text" style="margin-bottom: 15px;">
                        <span class="question-number">30</span>
                        What problem does Dr Chang highlight about Smith and Barker's research?
                    </div>
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 4px;">
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q30" value="A" onchange="saveAnswer(30, 'A')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">A - Its findings are inconclusive.</span>
                        </label>
                        <label style="display: block; margin-bottom: 12px; cursor: pointer;">
                            <input type="radio" name="q30" value="B" onchange="saveAnswer(30, 'B')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">B - It is too old to be useful.</span>
                        </label>
                        <label style="display: block; cursor: pointer;">
                            <input type="radio" name="q30" value="C" onchange="saveAnswer(30, 'C')" style="margin-right: 10px; cursor: pointer;">
                            <span style="font-size: 15px;">C - Its focus is limited.</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- SECTION 4 -->
            <div class="section-divider">SECTION 4 - Questions 31-40</div>

            <div class="question-block">
                <p class="instructions-text">Complete the notes below.<br>
                Write ONE WORD ONLY for each answer.</p>

                <div class="notes-box">
                    <h4>Field trial - heat pump technology</h4>
                    
                    <p style="font-weight: 600; margin-top: 15px; margin-bottom: 10px;">Background</p>
                    <div class="question-item">
                        <div class="question-text">
                            Aim in UK is to reduce carbon emissions from energy consumed in <span class="question-number">31</span>
                            <input type="text" id="q31" placeholder="answer" onchange="saveAnswer(31, this.value)" style="width: 150px;"> by approximately 25%
                        </div>
                    </div>

                    <div class="question-item">
                        <div class="question-text">
                            Most popular 'green' energy: <span class="question-number">32</span>
                            <input type="text" id="q32" placeholder="answer" onchange="saveAnswer(32, this.value)" style="width: 150px;">
                        </div>
                    </div>

                    <div class="question-item">
                        <div class="question-text">
                            Little investment in heat pumps in UK due to lack of <span class="question-number">33</span>
                            <input type="text" id="q33" placeholder="answer" onchange="saveAnswer(33, this.value)" style="width: 150px;"> in using them
                        </div>
                    </div>

                    <p style="font-weight: 600; margin-top: 20px; margin-bottom: 10px;">What is a heat pump?</p>
                    <div class="question-item">
                        <div class="question-text">
                            Heat pumps serve the same purpose as a <span class="question-number">34</span>
                            <input type="text" id="q34" placeholder="answer" onchange="saveAnswer(34, this.value)" style="width: 150px;">
                        </div>
                    </div>

                    <div class="question-item">
                        <div class="question-text">
                            Most heat pumps get heat from the earth or the <span class="question-number">35</span>
                            <input type="text" id="q35" placeholder="answer" onchange="saveAnswer(35, this.value)" style="width: 150px;">
                        </div>
                    </div>

                    <div class="question-item">
                        <div class="question-text">
                            Water is heated to 60°C to destroy <span class="question-number">36</span>
                            <input type="text" id="q36" placeholder="answer" onchange="saveAnswer(36, this.value)" style="width: 150px;">
                        </div>
                    </div>

                    <p style="font-weight: 600; margin-top: 20px; margin-bottom: 10px;">The field trial</p>
                    <p>83 sites across the UK</p>
                    
                    <div class="question-item">
                        <div class="question-text">
                            Central heating systems monitored: <span class="question-number">37</span>
                            <input type="text" id="q37" placeholder="answer" onchange="saveAnswer(37, this.value)" style="width: 150px;"> and under-floor heating
                        </div>
                    </div>

                    <p style="font-weight: 600; margin-top: 20px; margin-bottom: 10px;">Key conclusions:</p>
                    <div class="question-item">
                        <div class="question-text">
                            • installation: need to provide improved <span class="question-number">38</span>
                            <input type="text" id="q38" placeholder="answer" onchange="saveAnswer(38, this.value)" style="width: 150px;"> in pump-fitting technique
                        </div>
                    </div>

                    <div class="question-item">
                        <div class="question-text">
                            • <span class="question-number">39</span>
                            <input type="text" id="q39" placeholder="answer" onchange="saveAnswer(39, this.value)" style="width: 150px;"> designs performed best
                        </div>
                    </div>

                    <p style="margin: 15px 0;">• customers needed to be told about regulating the controls</p>

                    <div class="question-item">
                        <div class="question-text">
                            • need for a <span class="question-number">40</span>
                            <input type="text" id="q40" placeholder="answer" onchange="saveAnswer(40, this.value)" style="width: 150px;"> to co-ordinate the installation
                        </div>
                    </div>
                </div>
            </div>

            <div style="height: 80px;"></div>
        </div>

        <div class="bottom-nav">
            <button class="submit-btn" onclick="submitTest()">
                <svg style="width: 20px; height: 20px;" fill="white" viewBox="0 0 24 24">
                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
                Submit Test
            </button>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal" id="resultsModal">
        <div class="modal-content">
            <h2 class="modal-header">Your Answer Sheet</h2>
            <div class="answer-sheet" id="answerSheet"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="copy-btn" onclick="copyAnswers()">Copy Answers</button>
                <button class="close-btn" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>

    <div class="proctoring-warning" id="proctoringWarning">
        <h2>⚠️ Test Terminated</h2>
        <p>You left the test window.</p>
        <p>All answers have been deleted.</p>
    </div>

    <script>
        let studentName = '';
        let testSubmitted = false;
        let answers = {};
        let checkboxAnswers = {
            '19-20': [],
            '21-22': [],
            '23-24': [],
            '25-26': []
        };

        function validateName() {
            const nameInput = document.getElementById('studentName');
            const startBtn = document.getElementById('startBtn');
            studentName = nameInput.value.trim();
            
            if (studentName.length >= 2) {
                startBtn.disabled = false;
            } else {
                startBtn.disabled = true;
            }
        }

        function startTest() {
            if (studentName.length < 2) {
                alert('Please enter your full name before starting the test.');
                return;
            }

            document.getElementById('headerName').textContent = studentName;

            const elem = document.documentElement;
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.webkitRequestFullscreen) {
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) {
                elem.msRequestFullscreen();
            }

            document.getElementById('instructionsPage').style.display = 'none';
            document.getElementById('testPage').style.display = 'block';

            setTimeout(function() {
                const mainContainer = document.getElementById('mainContainer');
                if (mainContainer) {
                    wrapWords(mainContainer);
                }
            }, 100);
        }

        function saveAnswer(questionNum, value) {
            answers[questionNum] = value;
        }

        function saveCheckbox(q1, q2, value, checked) {
            const key = `${q1}-${q2}`;
            
            if (checked) {
                if (checkboxAnswers[key].length < 2) {
                    checkboxAnswers[key].push(value);
                } else {
                    event.target.checked = false;
                    alert(`You can only select 2 options for questions ${q1}-${q2}`);
                    return;
                }
            } else {
                const index = checkboxAnswers[key].indexOf(value);
                if (index > -1) {
                    checkboxAnswers[key].splice(index, 1);
                }
            }

            if (checkboxAnswers[key].length > 0) {
                answers[q1] = checkboxAnswers[key][0] || '';
            }
            if (checkboxAnswers[key].length > 1) {
                answers[q2] = checkboxAnswers[key][1] || '';
            }
        }

        function submitTest() {
            if (testSubmitted) return;
            testSubmitted = true;
            
            const answerSheet = document.getElementById('answerSheet');
            answerSheet.innerHTML = `
                <div class="answer-item" style="background: #dc143c; color: white;">
                    <span class="answer-label">Student Name:</span>
                    <span class="answer-value" style="color: white;">${studentName}</span>
                </div>
            `;
            
            for (let i = 1; i <= 40; i++) {
                const answerItem = document.createElement('div');
                answerItem.className = 'answer-item';
                answerItem.innerHTML = `
                    <span class="answer-label">Question ${i}:</span>
                    <span class="answer-value">${answers[i] || '(Not answered)'}</span>
                `;
                answerSheet.appendChild(answerItem);
            }
            
            document.getElementById('resultsModal').style.display = 'flex';
            generatePDF();
        }

        function copyAnswers() {
            let text = 'IELTS Listening Test - Answer Sheet\n\n';
            text += `Student Name: ${studentName}\n`;
            text += `Date: ${new Date().toLocaleString()}\n\n`;
            for (let i = 1; i <= 40; i++) {
                text += `Question ${i}: ${answers[i] || '(Not answered)'}\n`;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                alert('Answers copied to clipboard!');
            });
        }

        function closeModal() {
            document.getElementById('resultsModal').style.display = 'none';
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(20);
            doc.setTextColor(220, 20, 60);
            doc.text('EDUNEST - IELTS Listening Test', 105, 20, { align: 'center' });
            
            doc.setFontSize(12);
            doc.text('Answer Sheet', 105, 28, { align: 'center' });
            
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text(`Student Name: ${studentName}`, 20, 40);
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            doc.text(`Date: ${new Date().toLocaleString()}`, 20, 47);
            
            doc.setFontSize(11);
            let y = 60;
            
            for (let i = 1; i <= 40; i++) {
                const answer = answers[i] || '(Not answered)';
                doc.text(`Q${i}: ${answer}`, 20, y);
                y += 7;
                
                if (y > 280) {
                    doc.addPage();
                    y = 20;
                }
            }
            
            doc.save('IELTS_Listening_Test_Answers.pdf');
        }

        let violationCount = 0;
        const MAX_VIOLATIONS = 1;

        function handleViolation(reason) {
            violationCount++;
            
            if (violationCount >= MAX_VIOLATIONS) {
                answers = {};
                checkboxAnswers = {
                    '19-20': [],
                    '21-22': [],
                    '23-24': [],
                    '25-26': []
                };
                
                for (let i = 1; i <= 40; i++) {
                    const element = document.getElementById(`q${i}`);
                    if (element) element.value = '';
                    
                    const radios = document.getElementsByName(`q${i}`);
                    if (radios) {
                        radios.forEach(radio => radio.checked = false);
                    }
                }

                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                
                const warningDiv = document.getElementById('proctoringWarning');
                warningDiv.innerHTML = `
                    <h2>⚠️ Test Terminated</h2>
                    <p>${reason}</p>
                    <p>Your test has been automatically submitted.</p>
                    <p>All answers have been deleted.</p>
                `;
                warningDiv.style.display = 'block';
                
                document.querySelectorAll('input, select').forEach(el => {
                    el.disabled = true;
                });
                
                testSubmitted = true;
            }
        }

        function wrapWords(element) {
            const excludeTags = ['SCRIPT', 'STYLE', 'NOSCRIPT', 'IFRAME', 'OBJECT', 'INPUT', 'TEXTAREA', 'SELECT', 'BUTTON'];
            const textNodes = [];
            
            function getTextNodes(node) {
                if (node.nodeType === 3) {
                    textNodes.push(node);
                } else if (node.nodeType === 1) {
                    if (!excludeTags.includes(node.tagName) && !node.classList.contains('word-wrapper')) {
                        for (let child of node.childNodes) {
                            getTextNodes(child);
                        }
                    }
                }
            }
            
            getTextNodes(element);
            
            textNodes.forEach(textNode => {
                const text = textNode.textContent;
                const words = text.split(/(\s+)/);
                
                if (words.length > 1 || (words.length === 1 && text.trim())) {
                    const fragment = document.createDocumentFragment();
                    
                    words.forEach(word => {
                        if (word.trim()) {
                            const span = document.createElement('span');
                            span.className = 'word-wrapper';
                            span.textContent = word;
                            span.onclick = function(e) {
                                e.stopPropagation();
                                this.classList.toggle('highlighted-word');
                            };
                            fragment.appendChild(span);
                        } else if (word) {
                            fragment.appendChild(document.createTextNode(word));
                        }
                    });
                    
                    textNode.parentNode.replaceChild(fragment, textNode);
                }
            });
        }

        document.addEventListener('fullscreenchange', function() {
            if (!document.fullscreenElement && !testSubmitted && document.getElementById('testPage').style.display === 'block') {
                handleViolation('You exited full-screen mode.');
            }
        });

        document.addEventListener('webkitfullscreenchange', function() {
            if (!document.webkitFullscreenElement && !testSubmitted && document.getElementById('testPage').style.display === 'block') {
                handleViolation('You exited full-screen mode.');
            }
        });

        window.addEventListener('blur', function() {
            if (!testSubmitted && document.getElementById('testPage').style.display === 'block') {
                handleViolation('You left the test window.');
            }
        });

        document.addEventListener('visibilitychange', function() {
            if (document.hidden && !testSubmitted && document.getElementById('testPage').style.display === 'block') {
                handleViolation('You switched tabs or minimized the window.');
            }
        });

        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });

        window.addEventListener('beforeunload', function(e) {
            if (!testSubmitted && document.getElementById('testPage').style.display === 'block') {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>